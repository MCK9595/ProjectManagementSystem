@using ProjectManagementSystem.Shared.Models.DTOs
@using ProjectManagementSystem.WebApp.Wasm.Client.Components.Shared

<div class="active-tasks">
    <div class="active-tasks-header">
        <h5 class="tasks-title">
            <i class="fas fa-tasks me-2"></i>Active Tasks
        </h5>
        <small class="tasks-subtitle">Tasks within project period</small>
    </div>
    
    <div class="tasks-content">
        @if (IsLoading)
        {
            <LoadingSpinner IsVisible="true" Message="Loading active tasks..." Size="LoadingSpinner.SpinnerSize.Small" />
        }
        else if (ActiveTasksList?.Any() == true)
        {
            <div class="tasks-body">
                <div class="task-list">
                    @foreach (var task in ActiveTasksList)
                    {
                        <TaskCard Task="null" 
                                 DashboardTask="task"
                                 ShowStatus="true"
                                 ShowPriority="true"
                                 ShowDueDate="true"
                                 ShowAssignee="true"
                                 ShowDescription="false"
                                 ShowActions="false"
                                 Clickable="true"
                                 OnClick="OnTaskClick" />
                    }
                </div>
                
                @if (ShowViewAll && HasMoreTasks)
                {
                    <div class="tasks-footer">
                        <button type="button" class="btn btn-outline-primary btn-sm w-100" @onclick="OnViewAllClick">
                            <i class="fas fa-eye me-1"></i>View All Active Tasks
                        </button>
                    </div>
                }
            </div>
        }
        else
        {
            <EmptyState IsVisible="true"
                       IconClass="fas fa-clipboard-check"
                       Title="No active tasks"
                       Description="No tasks are currently active within the project period."
                       ShowAction="@ShowCreateAction"
                       ActionText="Create Task"
                       ActionIconClass="fas fa-plus"
                       ActionButtonClass="btn-primary"
                       OnActionClick="OnCreateTaskClick" />
        }
    </div>
</div>

@code {
    [Parameter] public bool IsLoading { get; set; } = false;
    [Parameter] public List<DashboardTaskDto>? ActiveTasksList { get; set; }
    [Parameter] public bool ShowViewAll { get; set; } = true;
    [Parameter] public bool HasMoreTasks { get; set; } = false;
    [Parameter] public bool ShowCreateAction { get; set; } = false;
    [Parameter] public EventCallback<TaskDto> OnTaskClick { get; set; }
    [Parameter] public EventCallback OnViewAllClick { get; set; }
    [Parameter] public EventCallback OnCreateTaskClick { get; set; }
}